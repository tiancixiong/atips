<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.26">
    <link rel="icon" href="./images/icons/favicon.ico"><title>ES入门 - 介绍 | atips</title><meta name="description" content="整理开发笔记、技巧、文档等">
    <link rel="preload" href="/atips/assets/js/runtime~app.006d820a.js" as="script"><link rel="preload" href="/atips/assets/css/styles.260bed4b.css" as="style"><link rel="preload" href="/atips/assets/js/8567.1b238c3e.js" as="script"><link rel="preload" href="/atips/assets/js/app.f3898035.js" as="script">
    <link rel="stylesheet" href="/atips/assets/css/styles.260bed4b.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/atips/" class=""><!----><span class="site-name">atips</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><a href="/atips/" class="nav-link" aria-label="Home"><!--[--><!--]--> Home <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Java"><span class="title">Java</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Java"><span class="title">Java</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>Java 基础</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/atips/java/basic/java-basic-oop/" class="nav-link" aria-label="Java 面向对象"><!--[--><!--]--> Java 面向对象 <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/atips/java/container/collection/java-collection-overview/" class="nav-link" aria-label="Java 集合框架"><!--[--><!--]--> Java 集合框架 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>Java进阶 - 并发框架</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/atips/java/concurrent/java-concurrent-overview/" class="nav-link" aria-label="Java 并发知识体系"><!--[--><!--]--> Java 并发知识体系 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>Java进阶 - 新版本特性</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/atips/java/java1.8/java-8-features-overview/" class="nav-link" aria-label="Java 8 特性"><!--[--><!--]--> Java 8 特性 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>Java进阶 - JVM相关</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/atips/java/jvm/java-jvm-agent-arthas/" class="nav-link" aria-label="Java 调试排错相关"><!--[--><!--]--> Java 调试排错相关 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="数据库"><span class="title">数据库</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="数据库"><span class="title">数据库</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>SQL 数据库</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/atips/database/mysql/mysql-commands/" class="nav-link" aria-label="MySQL 数据库"><!--[--><!--]--> MySQL 数据库 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>NoSQL 数据库</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/atips/database/nosql-redis/redis-overview/" class="nav-link" aria-label="Redis 数据库"><!--[--><!--]--> Redis 数据库 <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/atips/database/nosql-mongodb/mongodb-overview/" class="nav-link" aria-label="MongoDB 数据库"><!--[--><!--]--> MongoDB 数据库 <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/atips/database/nosql-elasticsearch/elasticsearch-overview/" class="nav-link" aria-label="Elasticsearch"><!--[--><!--]--> Elasticsearch <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="开发"><span class="title">开发</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="开发"><span class="title">开发</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>高并发架构</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/atips/mq/mq-overview/" class="nav-link" aria-label="消息队列"><!--[--><!--]--> 消息队列 <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/atips/database/nosql-elasticsearch/elasticsearch-overview/" class="nav-link" aria-label="搜索引擎"><!--[--><!--]--> 搜索引擎 <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/atips/database/nosql-redis/redis-overview/" class="nav-link" aria-label="缓存"><!--[--><!--]--> 缓存 <!--[--><!--]--></a></li><li class="dropdown-subitem"><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html" class="router-link-active router-link-exact-active nav-link router-link-active" aria-label="分库分表"><!--[--><!--]--> 分库分表 <!--[--><!--]--></a></li><li class="dropdown-subitem"><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html" class="router-link-active router-link-exact-active nav-link router-link-active" aria-label="读写分离"><!--[--><!--]--> 读写分离 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>高可用架构</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html" class="router-link-active router-link-exact-active nav-link router-link-active" aria-label="基于Hystrix"><!--[--><!--]--> 基于Hystrix <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>分布式系统</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html" class="router-link-active router-link-exact-active nav-link router-link-active" aria-label="分布式锁"><!--[--><!--]--> 分布式锁 <!--[--><!--]--></a></li><li class="dropdown-subitem"><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html" class="router-link-active router-link-exact-active nav-link router-link-active" aria-label="分布式事务"><!--[--><!--]--> 分布式事务 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>微服务架构</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html" class="router-link-active router-link-exact-active nav-link router-link-active" aria-label="基于Hystrix"><!--[--><!--]--> 基于Hystrix <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Spring"><span class="title">Spring</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Spring"><span class="title">Spring</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/atips/spring/spring-framework/" class="nav-link" aria-label="Spring 基础"><!--[--><!--]--> Spring 基础 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><a href="/atips/web/" class="nav-link" aria-label="Web"><!--[--><!--]--> Web <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="开发工具"><span class="title">开发工具</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="开发工具"><span class="title">开发工具</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>IDE</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/atips/software/ide/idea/basic-course/" class="nav-link" aria-label="IDEA"><!--[--><!--]--> IDEA <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>其他</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/atips/linux/linux-basic/" class="nav-link" aria-label="Linux"><!--[--><!--]--> Linux <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/atips/software/vcs/git-commit/" class="nav-link" aria-label="Git"><!--[--><!--]--> Git <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/atips/software/postman/" class="nav-link" aria-label="Postman"><!--[--><!--]--> Postman <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/atips/software/maven/" class="nav-link" aria-label="Maven"><!--[--><!--]--> Maven <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/atips/devops/docker/docker-basic/" class="nav-link" aria-label="Docker"><!--[--><!--]--> Docker <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><a href="/atips/about/about-me/" class="nav-link" aria-label="关于"><!--[--><!--]--> 关于 <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="切换夜间模式"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="Search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/atips/" class="nav-link" aria-label="Home"><!--[--><!--]--> Home <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Java"><span class="title">Java</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Java"><span class="title">Java</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>Java 基础</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/atips/java/basic/java-basic-oop/" class="nav-link" aria-label="Java 面向对象"><!--[--><!--]--> Java 面向对象 <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/atips/java/container/collection/java-collection-overview/" class="nav-link" aria-label="Java 集合框架"><!--[--><!--]--> Java 集合框架 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>Java进阶 - 并发框架</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/atips/java/concurrent/java-concurrent-overview/" class="nav-link" aria-label="Java 并发知识体系"><!--[--><!--]--> Java 并发知识体系 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>Java进阶 - 新版本特性</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/atips/java/java1.8/java-8-features-overview/" class="nav-link" aria-label="Java 8 特性"><!--[--><!--]--> Java 8 特性 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>Java进阶 - JVM相关</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/atips/java/jvm/java-jvm-agent-arthas/" class="nav-link" aria-label="Java 调试排错相关"><!--[--><!--]--> Java 调试排错相关 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="数据库"><span class="title">数据库</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="数据库"><span class="title">数据库</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>SQL 数据库</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/atips/database/mysql/mysql-commands/" class="nav-link" aria-label="MySQL 数据库"><!--[--><!--]--> MySQL 数据库 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>NoSQL 数据库</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/atips/database/nosql-redis/redis-overview/" class="nav-link" aria-label="Redis 数据库"><!--[--><!--]--> Redis 数据库 <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/atips/database/nosql-mongodb/mongodb-overview/" class="nav-link" aria-label="MongoDB 数据库"><!--[--><!--]--> MongoDB 数据库 <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/atips/database/nosql-elasticsearch/elasticsearch-overview/" class="nav-link" aria-label="Elasticsearch"><!--[--><!--]--> Elasticsearch <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="开发"><span class="title">开发</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="开发"><span class="title">开发</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>高并发架构</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/atips/mq/mq-overview/" class="nav-link" aria-label="消息队列"><!--[--><!--]--> 消息队列 <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/atips/database/nosql-elasticsearch/elasticsearch-overview/" class="nav-link" aria-label="搜索引擎"><!--[--><!--]--> 搜索引擎 <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/atips/database/nosql-redis/redis-overview/" class="nav-link" aria-label="缓存"><!--[--><!--]--> 缓存 <!--[--><!--]--></a></li><li class="dropdown-subitem"><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html" class="router-link-active router-link-exact-active nav-link router-link-active" aria-label="分库分表"><!--[--><!--]--> 分库分表 <!--[--><!--]--></a></li><li class="dropdown-subitem"><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html" class="router-link-active router-link-exact-active nav-link router-link-active" aria-label="读写分离"><!--[--><!--]--> 读写分离 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>高可用架构</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html" class="router-link-active router-link-exact-active nav-link router-link-active" aria-label="基于Hystrix"><!--[--><!--]--> 基于Hystrix <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>分布式系统</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html" class="router-link-active router-link-exact-active nav-link router-link-active" aria-label="分布式锁"><!--[--><!--]--> 分布式锁 <!--[--><!--]--></a></li><li class="dropdown-subitem"><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html" class="router-link-active router-link-exact-active nav-link router-link-active" aria-label="分布式事务"><!--[--><!--]--> 分布式事务 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>微服务架构</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html" class="router-link-active router-link-exact-active nav-link router-link-active" aria-label="基于Hystrix"><!--[--><!--]--> 基于Hystrix <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Spring"><span class="title">Spring</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Spring"><span class="title">Spring</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/atips/spring/spring-framework/" class="nav-link" aria-label="Spring 基础"><!--[--><!--]--> Spring 基础 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><a href="/atips/web/" class="nav-link" aria-label="Web"><!--[--><!--]--> Web <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="开发工具"><span class="title">开发工具</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="开发工具"><span class="title">开发工具</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>IDE</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/atips/software/ide/idea/basic-course/" class="nav-link" aria-label="IDEA"><!--[--><!--]--> IDEA <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>其他</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/atips/linux/linux-basic/" class="nav-link" aria-label="Linux"><!--[--><!--]--> Linux <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/atips/software/vcs/git-commit/" class="nav-link" aria-label="Git"><!--[--><!--]--> Git <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/atips/software/postman/" class="nav-link" aria-label="Postman"><!--[--><!--]--> Postman <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/atips/software/maven/" class="nav-link" aria-label="Maven"><!--[--><!--]--> Maven <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/atips/devops/docker/docker-basic/" class="nav-link" aria-label="Docker"><!--[--><!--]--> Docker <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><a href="/atips/about/about-me/" class="nav-link" aria-label="关于"><!--[--><!--]--> 关于 <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item">SQL - MySQL</p><ul class=""><li><!--[--><a href="/atips/database/mysql/mysql-commands.html" class="nav-link sidebar-item" aria-label="MySQL - 常用命令"><!--[--><!--]--> MySQL - 常用命令 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/atips/database/mysql/mysql-master-slave.html" class="nav-link sidebar-item" aria-label="MySQL - 主从复制"><!--[--><!--]--> MySQL - 主从复制 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">NoSQL - Redis</p><ul class=""><li><!--[--><a href="/atips/database/nosql-redis/redis-overview.html" class="nav-link sidebar-item" aria-label="Reids - Overview"><!--[--><!--]--> Reids - Overview <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/atips/database/nosql-redis/redis-introduce.html" class="nav-link sidebar-item" aria-label="Redis入门 - 概念和基础"><!--[--><!--]--> Redis入门 - 概念和基础 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/atips/database/nosql-redis/redis-data-types.html" class="nav-link sidebar-item" aria-label="Redis入门 - 数据类型：5种基础数据类型"><!--[--><!--]--> Redis入门 - 数据类型：5种基础数据类型 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/atips/database/nosql-redis/redis-data-types-special.html" class="nav-link sidebar-item" aria-label="Redis入门 - 数据类型：3种特殊类型"><!--[--><!--]--> Redis入门 - 数据类型：3种特殊类型 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">NoSQL - MongoDB</p><ul class=""><li><!--[--><a href="/atips/database/nosql-mongodb/mongodb-overview.html" class="nav-link sidebar-item" aria-label="MongoDB 知识体系"><!--[--><!--]--> MongoDB 知识体系 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/atips/database/nosql-mongodb/mongodb-basic.html" class="nav-link sidebar-item" aria-label="MongoDB入门 - 基础概念"><!--[--><!--]--> MongoDB入门 - 基础概念 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item active">NoSQL - Elasticsearch</p><ul class=""><li><!--[--><a href="/atips/database/nosql-elasticsearch/elasticsearch-overview.html" class="nav-link sidebar-item" aria-label="ElasticSearch 知识体系"><!--[--><!--]--> ElasticSearch 知识体系 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html" class="router-link-active router-link-exact-active nav-link router-link-active sidebar-item active" aria-label="ES入门 - 介绍"><!--[--><!--]--> ES入门 - 介绍 <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html#什么是elasticsearch" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="什么是ElasticSearch"><!--[--><!--]--> 什么是ElasticSearch <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html#elastic" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Elastic"><!--[--><!--]--> Elastic <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html#elasticsearch" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="ElasticSearch"><!--[--><!--]--> ElasticSearch <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html#为什么不是直接使用lucene" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="为什么不是直接使用Lucene"><!--[--><!--]--> 为什么不是直接使用Lucene <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html#elasticsearch的主要功能及应用场景" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="ElasticSearch的主要功能及应用场景"><!--[--><!--]--> ElasticSearch的主要功能及应用场景 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html#elasticsearch基础概念" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="ElasticSearch基础概念"><!--[--><!--]--> ElasticSearch基础概念 <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html#node-与-cluster" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Node 与 Cluster"><!--[--><!--]--> Node 与 Cluster <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html#index" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Index"><!--[--><!--]--> Index <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html#type" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Type"><!--[--><!--]--> Type <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html#document" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Document"><!--[--><!--]--> Document <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html#field" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Field"><!--[--><!--]--> Field <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html#shard" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Shard"><!--[--><!--]--> Shard <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html#replica" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Replica"><!--[--><!--]--> Replica <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html#核心数据类型" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="核心数据类型"><!--[--><!--]--> 核心数据类型 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html#es-核心概念-vs-db-核心概念" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="ES 核心概念 vs. DB 核心概念"><!--[--><!--]--> ES 核心概念 vs. DB 核心概念 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html#elasticsearch基本原理" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="ElasticSearch基本原理"><!--[--><!--]--> ElasticSearch基本原理 <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html#es-写数据过程" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="ES 写数据过程"><!--[--><!--]--> ES 写数据过程 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html#es-读数据过程" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="ES 读数据过程"><!--[--><!--]--> ES 读数据过程 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html#es-搜索数据过程" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="ES 搜索数据过程"><!--[--><!--]--> ES 搜索数据过程 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html#写数据底层原理" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="写数据底层原理"><!--[--><!--]--> 写数据底层原理 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html#删除-更新数据底层原理" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="删除/更新数据底层原理"><!--[--><!--]--> 删除/更新数据底层原理 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html#底层-lucene" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="底层 lucene"><!--[--><!--]--> 底层 lucene <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html#倒排索引" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="倒排索引"><!--[--><!--]--> 倒排索引 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a aria-current="page" href="/atips/database/nosql-elasticsearch/elasticsearch-introduce.html#参考资料" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="参考资料"><!--[--><!--]--> 参考资料 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a href="/atips/database/nosql-elasticsearch/elasticsearch-install.html" class="nav-link sidebar-item" aria-label="ES安装 - ElasticSearch和Kibana安装"><!--[--><!--]--> ES安装 - ElasticSearch和Kibana安装 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="es入门-介绍" tabindex="-1"><a class="header-anchor" href="#es入门-介绍" aria-hidden="true">#</a> ES入门 - 介绍</h1><h2 id="什么是elasticsearch" tabindex="-1"><a class="header-anchor" href="#什么是elasticsearch" aria-hidden="true">#</a> 什么是ElasticSearch</h2><h3 id="elastic" tabindex="-1"><a class="header-anchor" href="#elastic" aria-hidden="true">#</a> Elastic</h3><blockquote><p>Elastic官网：<a href="https://www.elastic.co/cn/" target="_blank" rel="noopener noreferrer">https://www.elastic.co/cn/<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p></blockquote><p>Elastic 有一条完整的产品线及解决方案：Elasticsearch、Kibana、Logstash等，前面说的三个就是大家常说的 ELK 技术栈。</p><h3 id="elasticsearch" tabindex="-1"><a class="header-anchor" href="#elasticsearch" aria-hidden="true">#</a> ElasticSearch</h3><blockquote><p>Elasticsearch官网：<a href="https://www.elastic.co/cn/products/elasticsearch" target="_blank" rel="noopener noreferrer">https://www.elastic.co/cn/products/elasticsearch<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p></blockquote><p><strong><a href="https://github.com/elastic/elasticsearch" target="_blank" rel="noopener noreferrer">Elasticsearch<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> 是一个分布式、RESTful 风格的搜索和数据分析引擎</strong>，能够解决不断涌现出的各种用例。 作为 Elastic Stack 的核心，它集中存储您的数据，帮助您发现意料之中以及意料之外的情况。Elasticsearch 基于搜索库 <a href="https://github.com/apache/lucene-solr" target="_blank" rel="noopener noreferrer">Lucene<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> 开发。ElasticSearch 隐藏了 Lucene 的复杂性，提供了简单易用的 REST API / Java API 接口（另外还有其他语言的 API 接口）。</p><p>ElasticSearch 可以视为一个文档存储，它<strong>将复杂数据结构序列化为 JSON 存储</strong>。<strong>ElasticSearch 是近乎于实时的全文搜素</strong>，这是指：</p><ul><li>从写入数据到数据可以被搜索，存在较小的延迟（大概是 1s）</li><li>基于 ES 执行搜索和分析可以达到秒级</li></ul><hr><p>它被用作<strong>全文检索</strong>、<strong>结构化搜索</strong>、<strong>分析</strong>以及这三个功能的组合：</p><ul><li><em>Wikipedia</em> 使用 Elasticsearch 提供带有高亮片段的全文搜索，还有 search-as-you-type 和 did-you-mean 的建议。</li><li><em>卫报</em> 使用 Elasticsearch 将网络社交数据结合到访客日志中，为它的编辑们提供公众对于新文章的实时反馈。</li><li><em>Stack Overflow</em> 将地理位置查询融入全文检索中去，并且使用 more-like-this 接口去查找相关的问题和回答。</li><li><em>GitHub</em> 使用 Elasticsearch 对1300亿行代码进行查询。</li><li>...</li></ul><p>除了搜索，结合Kibana、Logstash、Beats开源产品，Elastic Stack（简称ELK）还被广泛运用在大数据近实时分析领域，包括：<strong>日志分析</strong>、<strong>指标监控</strong>、<strong>信息安全</strong>等。它可以帮助你<strong>探索海量结构化、非结构化数据，按需创建可视化报表，对监控数据设置报警阈值，通过使用机器学习，自动识别异常状况</strong>。</p><p>ElasticSearch 是基于Restful WebApi，使用 Java 语言开发的搜索引擎库类，并作为 Apache 许可条款下的开放源码发布，是当前流行的企业级搜索引擎。其客户端在 Java、C#、PHP、Python 等许多语言中都是可用的。</p><h3 id="为什么不是直接使用lucene" tabindex="-1"><a class="header-anchor" href="#为什么不是直接使用lucene" aria-hidden="true">#</a> 为什么不是直接使用Lucene</h3><p>ElasticSearch是基于Lucene的，那么为什么不是直接使用Lucene呢？</p><p>Lucene 可以说是当下最先进、高性能、全功能的搜索引擎库。</p><p>但是 Lucene 仅仅只是一个库。为了充分发挥其功能，你需要使用 Java 并将 Lucene 直接集成到应用程序中。 更糟糕的是，您可能需要获得信息检索学位才能了解其工作原理。Lucene 非常 复杂。</p><p>Elasticsearch 也是使用 Java 编写的，它的内部使用 Lucene 做索引与搜索，但是它的目的是使全文检索变得简单，<strong>通过隐藏 Lucene 的复杂性，取而代之的提供一套简单一致的 RESTful API</strong>。</p><p>然而，Elasticsearch 不仅仅是 Lucene，并且也不仅仅只是一个全文搜索引擎。 它可以被下面这样准确的形容：</p><ul><li>一个分布式的实时文档存储，每个字段可以被索引与搜索</li><li>一个分布式实时分析搜索引擎</li><li>能胜任上百个服务节点的扩展，并支持 PB 级别的结构化或者非结构化数据</li></ul><h3 id="elasticsearch的主要功能及应用场景" tabindex="-1"><a class="header-anchor" href="#elasticsearch的主要功能及应用场景" aria-hidden="true">#</a> ElasticSearch的主要功能及应用场景</h3><ul><li><p>主要功能：</p><ul><li>海量数据的分布式存储以及集群管理，达到了服务与数据的高可用以及水平扩展；</li><li>近实时搜索，性能卓越。对结构化、全文、地理位置等类型数据的处理；</li><li>海量数据的近实时分析（聚合功能）。</li></ul></li><li><p>应用场景：</p><ul><li>网站搜索、垂直搜索、代码搜索；</li><li>日志管理与分析、安全指标监控、应用性能监控、Web抓取舆情分析。</li></ul></li></ul><h2 id="elasticsearch基础概念" tabindex="-1"><a class="header-anchor" href="#elasticsearch基础概念" aria-hidden="true">#</a> ElasticSearch基础概念</h2><h3 id="node-与-cluster" tabindex="-1"><a class="header-anchor" href="#node-与-cluster" aria-hidden="true">#</a> Node 与 Cluster</h3><p>Elastic 本质上是一个分布式数据库，允许多台服务器协同工作，每台服务器可以运行多个 Elastic 实例。</p><p>单个 Elastic 实例称为一个节点（node）。一组节点构成一个集群（cluster）。</p><p><strong>Cluster 集群</strong>：包含多个节点。一个集群由一个唯一的名字标识，默认为“<em>elasticsearch</em>”。集群名称非常重要，具有相同集群名的节点才会组成一个集群。集群名称可以在配置文件中指定。对于中小型应用来说，刚开始一个集群就一个节点很正常。</p><p><strong>Node 节点</strong>：存储集群的数据，参与集群的索引和搜索功能。像集群有名字，节点也有自己的名称，默认在启动时会以一个随机的 UUID 的前七个字符作为节点的名字，你可以为其指定任意的名字。通过集群名在网络中发现同伴组成集群。一个节点也可是集群。</p><h3 id="index" tabindex="-1"><a class="header-anchor" href="#index" aria-hidden="true">#</a> Index</h3><p><strong>Index 索引</strong>：可以认为是文档（document）的优化集合。每个索引有唯一的名字，通过这个名字来操作它。一个集群中可以有任意多个索引。</p><p>Elastic 会为所有字段建立索引，经过处理后写入一个反向索引（Inverted Index）。查找数据的时候，直接查找该索引。</p><p>所以，Elastic 数据管理的顶层单位就叫做 Index（索引）。它是单个数据库的同义词。每个 Index （即数据库）的名字必须是<em>小写</em>。</p><p>下面的命令可以查看当前节点的所有 Index：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">curl</span> -X GET <span class="token string">&#39;http://localhost:9200/_cat/indices?v&#39;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h3 id="type" tabindex="-1"><a class="header-anchor" href="#type" aria-hidden="true">#</a> Type</h3><p><strong>Type 类型</strong>：指在一个索引（Index ）中，可以索引不同类型的文档，如用户数据、博客数据。是 index 的一个逻辑分类。</p><p>Document 可以分组，比如 <code>weather</code> 这个 Index 里面，可以按城市分组（北京和上海），也可以按气候分组（晴天和雨天）。这种分组就叫做 Type，它是虚拟的逻辑分组，用来过滤 Document。</p><p>不同的 Type 应该有相似的结构（schema），举例来说，<code>id</code> 字段不能在这个组是字符串，在另一个组是数值。这是与关系型数据库的表的<a href="https://www.elastic.co/guide/en/elasticsearch/guide/current/mapping.html" target="_blank" rel="noopener noreferrer">一个区别<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>。性质完全不同的数据（比如 <code>products</code> 和 <code>logs</code>）应该存成两个 Index，而不是一个 Index 里面的两个 Type（虽然可以做到）。</p><p>下面的命令可以列出每个 Index 所包含的 Type。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">curl</span> <span class="token string">&#39;localhost:9200/_mapping?pretty=true&#39;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>根据<a href="https://www.elastic.co/blog/index-type-parent-child-join-now-future-in-elasticsearch" target="_blank" rel="noopener noreferrer">规划<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>，Elastic 6.x 版只允许每个 Index 包含一个 Type，7.x 版将会彻底移除 Type。</p><h3 id="document" tabindex="-1"><a class="header-anchor" href="#document" aria-hidden="true">#</a> Document</h3><p><strong>Document 文档</strong>：被索引的一条数据，索引的基本信息单元，以 JSON 格式来表示。Index 里面单条的记录称为 Document。许多条 Document 构成了一个 Index。</p><p>每个 Document 都是字段（Field）的集合。</p><p>Document 使用 JSON 格式表示，下面是一个例子：</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;user&quot;</span><span class="token operator">:</span> <span class="token string">&quot;张三&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;工程师&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;desc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;数据库管理&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>同一个 Index 里面的 Document，不要求有相同的结构（scheme），但是最好保持相同，这样有利于提高搜索效率。</p><h3 id="field" tabindex="-1"><a class="header-anchor" href="#field" aria-hidden="true">#</a> Field</h3><p><strong>Field 字段</strong>：是包含数据的键值对。</p><p>默认情况下，Elasticsearch 对每个字段中的所有数据建立索引，并且每个索引字段都具有专用的优化数据结构。</p><h3 id="shard" tabindex="-1"><a class="header-anchor" href="#shard" aria-hidden="true">#</a> Shard</h3><p><strong>Shard 分片</strong>：在创建一个索引时可以指定分成多少个分片来存储。每个分片本身也是一个功能完善且独立的“索引”，可以被放置在集群的任意节点上。</p><p>当单台机器不足以存储大量数据时，Elasticsearch 可以将一个索引中的数据切分为多个 shard 。shard 分布在多台服务器上存储。有了 shard 就可以横向扩展，存储更多数据，让搜索和分析等操作分布到多台服务器上去执行，提升吞吐量和性能。每个 shard 都是一个 lucene index。</p><h3 id="replica" tabindex="-1"><a class="header-anchor" href="#replica" aria-hidden="true">#</a> Replica</h3><p><strong>Replication 备份</strong>：一个分片可以有多个备份（副本）。</p><p>任何一个服务器随时可能故障或宕机，此时 shard 可能就会丢失，因此可以为每个 shard 创建多个 replica。replica 可以在 shard 故障时提供备用服务，保证数据不丢失，多个 replica 还可以提升搜索操作的吞吐量和性能。</p><p>默认每个索引 10 个 shard，5 个 primary shard，5 个 replica shard，最小的高可用配置，是 2 台服务器。primary shard（建立索引时一次设置，不能修改，默认 5 个），replica shard（随时修改数量，默认 1 个）。</p><h3 id="核心数据类型" tabindex="-1"><a class="header-anchor" href="#核心数据类型" aria-hidden="true">#</a> 核心数据类型</h3><p>Elasticsearch中支持的数据类型非常丰富：</p><p><img src="img/1531712631982.png" alt="Field datatypes"></p><p>我们说几个关键的：</p><ul><li><p>String 类型，又分两种：</p><ul><li><code>text</code>：可分词，不可参与聚合</li><li><code>keyword</code>：不可分词，数据会作为完整字段进行匹配，可以参与聚合</li></ul></li><li><p>Numerical：数值类型，分两类</p><ul><li>基本数据类型：<code>long</code>、<code>interger</code>、<code>short</code>、<code>byte</code>、<code>double</code>、<code>float</code>、<code>half_float</code></li><li>浮点数的高精度类型：<code>scaled_float</code><ul><li>需要指定一个精度因子，比如 10 或 100。elasticsearch 会把真实值乘以这个因子后存储，取出时再还原。</li></ul></li></ul></li><li><p>boolean 数值型</p></li><li><p>date：日期类型</p><p>elasticsearch 可以对日期格式化为字符串存储，但是建议我们存储为毫秒值，存储为 <em>long</em>，节省空间。</p><p>由于 Json 没有 date 类型，所以 es 通过识别字符串是否符合 format 定义的格式来判断是否为 date 类型。format 默认为：<code>strict_date_optional_time</code>、<code>epoch_millis</code></p></li><li><p>binary：二进制，该类型的字段把值当做经过 base64 编码的字符串，默认不存储，且不可搜索</p></li><li><p>Range datatypes，范围类型。范围类型表示值是一个范围，而不是⼀个具体的值。分为：integer_range, float_range, long_range, double_range, date_range。</p><p>譬如 age 的类型是 integer_range，那么值可以是 <code>{&quot;gte&quot; : 20, &quot;lte&quot; : 40}</code>；搜索 <code>&quot;term&quot; : {&quot;age&quot;: 21}</code> 可以搜索该值。</p></li></ul><blockquote><p>更多详情：<a href="https://www.elastic.co/guide/en/elasticsearch/reference/6.8/mapping-types.html#_core_datatypes" target="_blank" rel="noopener noreferrer">Field datatypes<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p></blockquote><h3 id="es-核心概念-vs-db-核心概念" tabindex="-1"><a class="header-anchor" href="#es-核心概念-vs-db-核心概念" aria-hidden="true">#</a> ES 核心概念 vs. DB 核心概念</h3><p>为了方便理解，作一个ES和数据库的对比：</p><p><img src="//gcore.jsdelivr.net/gh/tiancixiong/atips@img-230529/images/database/nosql-elasticsearch/1227483-20180616115111006-1555585138.png" alt="img"></p><h2 id="elasticsearch基本原理" tabindex="-1"><a class="header-anchor" href="#elasticsearch基本原理" aria-hidden="true">#</a> ElasticSearch基本原理</h2><h3 id="es-写数据过程" tabindex="-1"><a class="header-anchor" href="#es-写数据过程" aria-hidden="true">#</a> ES 写数据过程</h3><ul><li>客户端选择一个 node 发送请求过去，这个 node 就是 <code>coordinating node</code>（协调节点）。</li><li><code>coordinating node</code> 对 document 进行<strong>路由</strong>，将请求转发给对应的 node（有 primary shard）。</li><li>实际的 node 上的 <code>primary shard</code> 处理请求，然后将数据同步到 <code>replica node</code>。</li><li><code>coordinating node</code> 如果发现 <code>primary node</code> 和所有 <code>replica node</code> 都搞定之后，就返回响应结果给客户端。</li></ul><p><img src="//gcore.jsdelivr.net/gh/tiancixiong/atips@img-230529/images/database/nosql-elasticsearch/es-write.png" alt="es-write"></p><h3 id="es-读数据过程" tabindex="-1"><a class="header-anchor" href="#es-读数据过程" aria-hidden="true">#</a> ES 读数据过程</h3><p>可以通过 <code>doc id</code> 来查询，会根据 <code>doc id</code> 进行 hash，判断出来当时把 <code>doc id</code> 分配到了哪个 shard 上面去，从那个 shard 去查询。</p><ul><li>客户端发送请求到<strong>任意</strong>一个 node，成为 <code>coordinate node</code>。</li><li><code>coordinate node</code> 对 <code>doc id</code> 进行哈希路由，将请求转发到对应的 node，此时会使用 <code>round-robin</code> <strong>随机轮询算法</strong>，在 <code>primary shard</code> 以及其所有 replica 中随机选择一个，让读请求负载均衡。</li><li>接收请求的 node 返回 document 给 <code>coordinate node</code>。</li><li><code>coordinate node</code> 返回 document 给客户端。</li></ul><h3 id="es-搜索数据过程" tabindex="-1"><a class="header-anchor" href="#es-搜索数据过程" aria-hidden="true">#</a> ES 搜索数据过程</h3><p>es 最强大的是做全文检索，就是比如你有三条数据：</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>java真好玩儿啊
java好难学啊
j2ee特别牛
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>你根据 <code>java</code> 关键词来搜索，将包含 <code>java</code> 的 <code>document</code> 给搜索出来。es 就会给你返回：java真好玩儿啊、java好难学啊。</p><ul><li>客户端发送请求到一个 <code>coordinate node</code> 。</li><li>协调节点将搜索请求转发到<strong>所有</strong>的 shard 对应的 <code>primary shard</code> 或 <code>replica shard</code> ，都可以。</li><li>query phase：每个 shard 将自己的搜索结果（其实就是一些 <code>doc id</code> ）返回给协调节点，由协调节点进行数据的合并、排序、分页等操作，产出最终结果。</li><li>fetch phase：接着由协调节点根据 <code>doc id</code> 去各个节点上<strong>拉取实际</strong>的 <code>document</code> 数据，最终返回给客户端。</li></ul><blockquote><p>写请求是写入 primary shard，然后同步给所有的 replica shard；读请求可以从 primary shard 或 replica shard 读取，采用的是随机轮询算法。</p></blockquote><h3 id="写数据底层原理" tabindex="-1"><a class="header-anchor" href="#写数据底层原理" aria-hidden="true">#</a> 写数据底层原理</h3><p><img src="//gcore.jsdelivr.net/gh/tiancixiong/atips@img-230529/images/database/nosql-elasticsearch/es-write-detail.png" alt="es-write-detail"></p><p>先写入内存 buffer，在 buffer 里的时候数据是搜索不到的；同时将数据写入 translog 日志文件。</p><p>如果 buffer 快满了，或者到一定时间，就会将内存 buffer 数据 <code>refresh</code> 到一个新的 <code>segment file</code> 中，但是此时数据不是直接进入 <code>segment file</code> 磁盘文件，而是先进入 <code>os cache</code> 。这个过程就是 <code>refresh</code>。</p><p>每隔 1 秒钟，es 将 buffer 中的数据写入一个<strong>新的</strong> <code>segment file</code>，每秒钟会产生一个<strong>新的磁盘文件</strong> <code>segment file</code>，这个 <code>segment file</code> 中就存储最近 1 秒内 buffer 中写入的数据。</p><p>但是如果 buffer 里面此时没有数据，那当然不会执行 refresh 操作，如果 buffer 里面有数据，默认 1 秒钟执行一次 refresh 操作，刷入一个新的 segment file 中。</p><p>操作系统里面，磁盘文件其实都有一个东西，叫做 <code>os cache</code>，即操作系统缓存，就是说数据写入磁盘文件之前，会先进入 <code>os cache</code>，先进入操作系统级别的一个内存缓存中去。只要 <code>buffer</code> 中的数据被 refresh 操作刷入 <code>os cache</code>中，这个数据就可以被搜索到了。</p><p>为什么叫 es 是<strong>准实时</strong>的？ <code>NRT</code>，全称 <code>near real-time</code>。默认是每隔 1 秒 refresh 一次的，所以 es 是准实时的，因为写入的数据 1 秒之后才能被看到。可以通过 es 的 <code>restful api</code> 或者 <code>java api</code>，<strong>手动</strong>执行一次 refresh 操作，就是手动将 buffer 中的数据刷入 <code>os cache</code>中，让数据立马就可以被搜索到。只要数据被输入 <code>os cache</code> 中，buffer 就会被清空了，因为不需要保留 buffer 了，数据在 translog 里面已经持久化到磁盘去一份了。</p><p>重复上面的步骤，新的数据不断进入 buffer 和 translog，不断将 <code>buffer</code> 数据写入一个又一个新的 <code>segment file</code> 中去，每次 <code>refresh</code> 完 buffer 清空，translog 保留。随着这个过程推进，translog 会变得越来越大。当 translog 达到一定长度的时候，就会触发 <code>commit</code> 操作。</p><p>commit 操作发生第一步，就是将 buffer 中现有数据 <code>refresh</code> 到 <code>os cache</code> 中去，清空 buffer。然后，将一个 <code>commit point</code> 写入磁盘文件，里面标识着这个 <code>commit point</code> 对应的所有 <code>segment file</code>，同时强行将 <code>os cache</code> 中目前所有的数据都 <code>fsync</code> 到磁盘文件中去。最后<strong>清空</strong> 现有 translog 日志文件，重启一个 translog，此时 commit 操作完成。</p><p>这个 commit 操作叫做 <code>flush</code>。默认 30 分钟自动执行一次 <code>flush</code>，但如果 translog 过大，也会触发 <code>flush</code>。flush 操作就对应着 commit 的全过程，我们可以通过 es api，手动执行 flush 操作，手动将 os cache 中的数据 fsync 强刷到磁盘上去。</p><p>translog 日志文件的作用是什么？你执行 commit 操作之前，数据要么是停留在 buffer 中，要么是停留在 os cache 中，无论是 buffer 还是 os cache 都是内存，一旦这台机器死了，内存中的数据就全丢了。所以需要将数据对应的操作写入一个专门的日志文件 <code>translog</code> 中，一旦此时机器宕机，再次重启的时候，es 会自动读取 translog 日志文件中的数据，恢复到内存 buffer 和 os cache 中去。</p><p>translog 其实也是先写入 os cache 的，默认每隔 5 秒刷一次到磁盘中去，所以默认情况下，可能有 5 秒的数据会仅仅停留在 buffer 或者 translog 文件的 os cache 中，如果此时机器挂了，会<strong>丢失</strong> 5 秒钟的数据。但是这样性能比较好，最多丢 5 秒的数据。也可以将 translog 设置成每次写操作必须是直接 <code>fsync</code> 到磁盘，但是性能会差很多。</p><p>实际上你在这里，如果面试官没有问你 es 丢数据的问题，你可以在这里给面试官炫一把，你说，其实 es 第一是准实时的，数据写入 1 秒后可以搜索到；可能会丢失数据的。有 5 秒的数据，停留在 buffer、translog os cache、segment file os cache 中，而不在磁盘上，此时如果宕机，会导致 5 秒的<strong>数据丢失</strong>。</p><p><strong>总结一下</strong>，数据先写入内存 buffer，然后每隔 1s，将数据 refresh 到 os cache，到了 os cache 数据就能被搜索到（所以我们才说 es 从写入到能被搜索到，中间有 1s 的延迟）。每隔 5s，将数据写入 translog 文件（这样如果机器宕机，内存数据全没，最多会有 5s 的数据丢失），translog 大到一定程度，或者默认每隔 30mins，会触发 commit 操作，将缓冲区的数据都 flush 到 segment file 磁盘文件中。</p><blockquote><p>数据写入 segment file 之后，同时就建立好了倒排索引。</p></blockquote><h3 id="删除-更新数据底层原理" tabindex="-1"><a class="header-anchor" href="#删除-更新数据底层原理" aria-hidden="true">#</a> 删除/更新数据底层原理</h3><p>如果是删除操作，commit 的时候会生成一个 <code>.del</code> 文件，里面将某个 doc 标识为 <code>deleted</code> 状态，那么搜索的时候根据 <code>.del</code> 文件就知道这个 doc 是否被删除了。</p><p>如果是更新操作，就是将原来的 doc 标识为 <code>deleted</code> 状态，然后新写入一条数据。</p><p>buffer 每 refresh 一次，就会产生一个 <code>segment file</code>，所以默认情况下是 1 秒钟一个 <code>segment file</code>，这样下来 <code>segment file</code> 会越来越多，此时会定期执行 merge。每次 merge 的时候，会将多个 <code>segment file</code> 合并成一个，同时这里会将标识为 <code>deleted</code> 的 doc 给<strong>物理删除掉</strong>，然后将新的 <code>segment file</code> 写入磁盘，这里会写一个 <code>commit point</code>，标识所有新的 <code>segment file</code>，然后打开 <code>segment file</code> 供搜索使用，同时删除旧的 <code>segment file</code>。</p><h3 id="底层-lucene" tabindex="-1"><a class="header-anchor" href="#底层-lucene" aria-hidden="true">#</a> 底层 lucene</h3><p>简单来说，lucene 就是一个 jar 包，里面包含了封装好的各种建立倒排索引的算法代码。我们用 Java 开发的时候，引入 lucene jar，然后基于 lucene 的 api 去开发就可以了。</p><p>通过 lucene，我们可以将已有的数据建立索引，lucene 会在本地磁盘上面，给我们组织索引的数据结构。</p><h3 id="倒排索引" tabindex="-1"><a class="header-anchor" href="#倒排索引" aria-hidden="true">#</a> 倒排索引</h3><p>在搜索引擎中，每个文档都有一个对应的文档 ID，文档内容被表示为一系列关键词的集合。例如，文档 1 经过分词，提取了 20 个关键词，每个关键词都会记录它在文档中出现的次数和出现位置。</p><p>那么，倒排索引就是<strong>关键词到文档</strong> ID 的映射，每个关键词都对应着一系列的文件，这些文件中都出现了关键词。</p><p>举个栗子。</p><p>有以下文档：</p><table><thead><tr><th>DocId</th><th>Doc</th></tr></thead><tbody><tr><td>1</td><td>谷歌地图之父跳槽 Facebook</td></tr><tr><td>2</td><td>谷歌地图之父加盟 Facebook</td></tr><tr><td>3</td><td>谷歌地图创始人拉斯离开谷歌加盟 Facebook</td></tr><tr><td>4</td><td>谷歌地图之父跳槽 Facebook 与 Wave 项目取消有关</td></tr><tr><td>5</td><td>谷歌地图之父拉斯加盟社交网站 Facebook</td></tr></tbody></table><p>对文档进行分词之后，得到以下<strong>倒排索引</strong>。</p><table><thead><tr><th>WordId</th><th>Word</th><th>DocIds</th></tr></thead><tbody><tr><td>1</td><td>谷歌</td><td>1,2,3,4,5</td></tr><tr><td>2</td><td>地图</td><td>1,2,3,4,5</td></tr><tr><td>3</td><td>之父</td><td>1,2,4,5</td></tr><tr><td>4</td><td>跳槽</td><td>1,4</td></tr><tr><td>5</td><td>Facebook</td><td>1,2,3,4,5</td></tr><tr><td>6</td><td>加盟</td><td>2,3,5</td></tr><tr><td>7</td><td>创始人</td><td>3</td></tr><tr><td>8</td><td>拉斯</td><td>3,5</td></tr><tr><td>9</td><td>离开</td><td>3</td></tr><tr><td>10</td><td>与</td><td>4</td></tr><tr><td>..</td><td>..</td><td>..</td></tr></tbody></table><p>另外，实用的倒排索引还可以记录更多的信息，比如文档频率信息，表示在文档集合中有多少个文档包含某个单词。</p><p>那么，有了倒排索引，搜索引擎可以很方便地响应用户的查询。比如用户输入查询 <code>Facebook</code>，搜索系统查找倒排索引，从中读出包含这个单词的文档，这些文档就是提供给用户的搜索结果。</p><p>要注意倒排索引的两个重要细节：</p><ul><li>倒排索引中的所有词项对应一个或多个文档；</li><li>倒排索引中的词项<strong>根据字典顺序升序排列</strong></li></ul><blockquote><p>上面只是一个简单的栗子，并没有严格按照字典顺序升序排列。</p></blockquote><h2 id="参考资料" tabindex="-1"><a class="header-anchor" href="#参考资料" aria-hidden="true">#</a> 参考资料</h2><ul><li>http://www.ruanyifeng.com/blog/2017/08/elasticsearch.html</li><li>https://dunwu.github.io/db-tutorial/nosql/elasticsearch/elasticsearch-quickstart.html</li><li>https://doocs.github.io/advanced-java/#/./docs/high-concurrency/es-write-query-search</li></ul><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="nav-link external meta-item-label" href="https://github.com/tiancixiong/atips/edit/master/docs/database/nosql-elasticsearch/elasticsearch-introduce.md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页"><!--[--><!--]--> 在 GitHub 上编辑此页 <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">上次更新: </span><span class="meta-item-info">2024/7/1 12:20:12</span></div><div class="meta-item contributors"><span class="meta-item-label">贡献者: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: tiancixiong@163.com">Tianci.Xiong</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: tiancixiong@163.com">TianCi.Xiong</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"> ← <a href="/atips/database/nosql-elasticsearch/elasticsearch-overview.html" class="nav-link" aria-label="ElasticSearch 知识体系"><!--[--><!--]--> ElasticSearch 知识体系 <!--[--><!--]--></a></span><span class="next"><a href="/atips/database/nosql-elasticsearch/elasticsearch-install.html" class="nav-link" aria-label="ES安装 - ElasticSearch和Kibana安装"><!--[--><!--]--> ES安装 - ElasticSearch和Kibana安装 <!--[--><!--]--></a> → </span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script src="/atips/assets/js/runtime~app.006d820a.js" defer></script><script src="/atips/assets/js/8567.1b238c3e.js" defer></script><script src="/atips/assets/js/app.f3898035.js" defer></script>
  </body>
</html>
