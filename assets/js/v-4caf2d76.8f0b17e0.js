"use strict";(self.webpackChunkatips=self.webpackChunkatips||[]).push([[8358],{2480:(n,s,a)=>{a.r(s),a.d(s,{data:()=>e});const e={key:"v-4caf2d76",path:"/database/nosql-redis/redis-data-types-special.html",title:"Redis入门 - 数据类型：3种特殊类型",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:2,title:"HyperLogLog 基数统计",slug:"hyperloglog-基数统计",children:[{level:3,title:"HyperLogLog 命令",slug:"hyperloglog-命令",children:[]}]},{level:2,title:"BitMap 位图",slug:"bitmap-位图",children:[{level:3,title:"BitMap 命令",slug:"bitmap-命令",children:[]}]},{level:2,title:"Geospatial 地理位置",slug:"geospatial-地理位置",children:[{level:3,title:"geoadd",slug:"geoadd",children:[]},{level:3,title:"geopos",slug:"geopos",children:[]},{level:3,title:"geodist",slug:"geodist",children:[]},{level:3,title:"georadius",slug:"georadius",children:[]},{level:3,title:"georadiusbymember",slug:"georadiusbymember",children:[]},{level:3,title:"geohash(较少使用)",slug:"geohash-较少使用",children:[]},{level:3,title:"底层",slug:"底层",children:[]}]},{level:2,title:"参考资料",slug:"参考资料",children:[]}],filePathRelative:"database/nosql-redis/redis-data-types-special.md",git:{updatedTime:1701927383e3,contributors:[{name:"TianCi.Xiong",email:"tiancixiong@163.com",commits:1},{name:"Tianci.Xiong",email:"tiancixiong@163.com",commits:1}]}}},5074:(n,s,a)=>{a.r(s),a.d(s,{default:()=>gn});var e=a(6252);const p=(0,e.uE)('<h1 id="redis入门-数据类型-3种特殊类型" tabindex="-1"><a class="header-anchor" href="#redis入门-数据类型-3种特殊类型" aria-hidden="true">#</a> Redis入门 - 数据类型：3种特殊类型</h1><p>Redis除了上文中 5 种基础数据类型，还有 3 种特殊的数据类型，分别是 <strong>HyperLogLogs</strong>（基数统计）， <strong>Bitmaps</strong> (位图) 和 <strong>geospatial</strong> （地理位置）。</p><h2 id="hyperloglog-基数统计" tabindex="-1"><a class="header-anchor" href="#hyperloglog-基数统计" aria-hidden="true">#</a> HyperLogLog 基数统计</h2><blockquote><p>可用版本： &gt;= 2.8.9</p></blockquote><p>HyperLogLog 是用于计算唯一事物的概率数据结构（从技术上讲，这被称为估计集合的基数）。如果统计唯一项，项目越多，需要的内存就越多。因为需要记住过去已经看过的项，从而避免多次统计这些项。</p><ul><li><strong>什么是基数？</strong></li></ul><p>举个例子，A = {1, 2, 3, 4, 5}， B = {3, 5, 6, 7, 9}；那么基数（不重复的元素）= 1, 2, 4, 6, 7, 9； （允许容错，即可以接受一定误差）。</p><ul><li><strong>HyperLogLogs 基数统计用来解决什么问题</strong>？</li></ul><p>这个结构可以非常省内存的去统计各种计数，比如注册 IP 数、每日访问 IP 数、页面实时UV、在线用户数，共同好友数等。</p><ul><li><strong>它的优势体现在哪</strong>？</li></ul><p>一个大型的网站，每天 IP 比如有 100 万，粗算一个 IP 消耗 15 字节，那么 100 万个 IP 就是 15M。而 HyperLogLog 在 Redis 中每个键占用的内容都是 12K，理论存储近似接近 2^64 个值，不管存储的内容是什么，它一个基于基数估算的算法，只能比较准确的估算出基数，可以使用少量固定的内存去存储并识别集合中的唯一元素。而且这个估算的基数并不一定准确，是一个带有 0.81% 标准错误的近似值（对于可以接受一定容错的业务场景，比如IP数统计，UV等，是可以忽略不计的）。</p><h3 id="hyperloglog-命令" tabindex="-1"><a class="header-anchor" href="#hyperloglog-命令" aria-hidden="true">#</a> HyperLogLog 命令</h3>',12),t={href:"http://redisdoc.com/hyperloglog/pfadd.html",target:"_blank",rel:"noopener noreferrer"},o=(0,e.Uk)("pfadd"),l=(0,e.Uk)(" - 将任意数量的元素添加到指定的 HyperLogLog 里面。"),r={href:"http://redisdoc.com/hyperloglog/pfcount.html",target:"_blank",rel:"noopener noreferrer"},c=(0,e.Uk)("pfcount"),i=(0,e.Uk)(" - 返回给定 HyperLogLog 的基数估算值。"),u={href:"http://redisdoc.com/hyperloglog/pfmerge.html",target:"_blank",rel:"noopener noreferrer"},b=(0,e.Uk)("pfmerge"),m=(0,e.Uk)(" - 将多个 HyperLogLog 合并（merge）为一个 HyperLogLog ， 合并后的 HyperLogLog 的基数接近于所有输入 HyperLogLog 的可见集合（observed set）的并集。合并得出的 HyperLogLog 会被储存在 "),k=(0,e._)("code",null,"destkey",-1),g=(0,e.Uk)(" 键里面， 如果该键并不存在， 那么命令在执行之前， 会先为该键创建一个空的 HyperLogLog 。"),d=(0,e.uE)('<p>示例</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> pfadd key1 a b c d\t\t<span class="token comment"># 创建第一组元素</span>\n<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>\n<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> pfcount key1\t\t\t<span class="token comment"># 统计元素的基数数量</span>\n<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">9</span>\n<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> pfadd key2 c d e f g\t<span class="token comment"># 创建第二组元素</span>\n<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>\n<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> pfcount key2\n<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">10</span>\n<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> pfmerge key3 key1 key2\t<span class="token comment"># 合并两组：key1 key2 -&gt; key3 并集</span>\nOK\n<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> pfcount key3\n<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">13</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="bitmap-位图" tabindex="-1"><a class="header-anchor" href="#bitmap-位图" aria-hidden="true">#</a> BitMap 位图</h2><blockquote><p>可用版本： &gt;= 2.2.0</p></blockquote><blockquote><p>Bitmap 即位图数据结构，都是操作二进制位来进行记录，只有 0 和 1 两个状态。</p></blockquote><p>BitMap 即位图。BitMap 不是一个真实的数据结构。而是 String 类型上的一组面向 bit 操作的集合。由于 String 是二进制安全的 blob，并且它们的最大长度是 512m，所以 BitMap 能最大设置 $$2^{32}$$ 个不同的 bit。</p><p>BitMap 的最大优点就是存储信息时可以节省大量的空间。例如在一个系统中，不同的用户被一个增长的用户 ID 表示。40 亿（$$2^{32}$$ = $$4<em>1024</em>1024*1024$$ ≈ 40 亿）用户只需要 512M 内存就能记住某种信息，例如用户是否登录过。</p><ul><li><strong>用来解决什么问题</strong>？</li></ul><p>比如：统计用户信息，活跃，不活跃！ 登录，未登录！ 打卡，不打卡！ <strong>两个状态的，都可以使用 Bitmaps</strong>！</p><p>如果存储一年的打卡状态需要多少内存呢？ <em>365 天 = 365 bit 1字节 = 8bit</em>，需要 46 个字节左右！</p><h3 id="bitmap-命令" tabindex="-1"><a class="header-anchor" href="#bitmap-命令" aria-hidden="true">#</a> BitMap 命令</h3>',11),h={href:"http://redisdoc.com/bitmap/setbit.html",target:"_blank",rel:"noopener noreferrer"},q=(0,e.Uk)("setbit"),f=(0,e.Uk)(" - 对 "),y=(0,e._)("code",null,"key",-1),_=(0,e.Uk)(" 所储存的字符串值，设置或清除指定偏移量上的位(bit)。"),v={href:"http://redisdoc.com/bitmap/getbit.html",target:"_blank",rel:"noopener noreferrer"},x=(0,e.Uk)("getbit"),L=(0,e.Uk)(" - 对 "),U=(0,e._)("code",null,"key",-1),w=(0,e.Uk)(" 所储存的字符串值，获取指定偏移量上的位(bit)。"),H={href:"http://redisdoc.com/bitmap/bitcount.html",target:"_blank",rel:"noopener noreferrer"},W=(0,e.Uk)("bitcount"),B=(0,e.Uk)(" - 计算给定字符串中，被设置为 "),z=(0,e._)("code",null,"1",-1),$=(0,e.Uk)(" 的比特位的数量。"),I={href:"http://redisdoc.com/bitmap/bitpos.html",target:"_blank",rel:"noopener noreferrer"},j=(0,e.Uk)("BITPOS"),M={href:"http://redisdoc.com/bitmap/bitop.html",target:"_blank",rel:"noopener noreferrer"},P=(0,e.Uk)("BITOP"),E={href:"http://redisdoc.com/bitmap/bitfield.html",target:"_blank",rel:"noopener noreferrer"},R=(0,e.Uk)("BITFIELD"),G=(0,e.uE)('<p>示例：</p><p>使用 bitmap 来记录 周一到周日的打卡！ 周一：1 周二：0 周三：0 周四：1 ......</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setbit sign <span class="token number">0</span> <span class="token number">1</span>\n<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>\n<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setbit sign <span class="token number">1</span> <span class="token number">1</span>\n<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>\n<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setbit sign <span class="token number">2</span> <span class="token number">0</span>\n<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>\n<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setbit sign <span class="token number">3</span> <span class="token number">1</span>\n<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>\n<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setbit sign <span class="token number">4</span> <span class="token number">0</span>\n<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>\n<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setbit sign <span class="token number">5</span> <span class="token number">0</span>\n<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>\n<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> setbit sign <span class="token number">6</span> <span class="token number">1</span>\n<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>查看某一天是否有打卡：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> getbit sign <span class="token number">3</span>\n<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>\n<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> getbit sign <span class="token number">5</span>\n<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>统计操作，统计打卡的天数：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> bitcount sign <span class="token comment"># 统计这周的打卡记录，就可以看到是否有全勤</span>\n<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">4</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="geospatial-地理位置" tabindex="-1"><a class="header-anchor" href="#geospatial-地理位置" aria-hidden="true">#</a> Geospatial 地理位置</h2><blockquote><p>可用版本： &gt;= 3.2.0</p></blockquote><p>Redis 的 Geo 可以将用户给定的地理位置（经度和纬度）信息储存起来，并对这些信息进行操作。 这个功能可以推算地理位置的信息：两地之间的距离，方圆几里的人。</p><p>我们日常生活中的定位、查看附近的人、朋友的定位、打车距离计算等等，基本上都是使用Geospatial 。</p>',11),T=(0,e._)("thead",null,[(0,e._)("tr",null,[(0,e._)("th",null,"命令"),(0,e._)("th",null,"描述")])],-1),O={href:"http://redisdoc.com/geo/geoadd.html",target:"_blank",rel:"noopener noreferrer"},C=(0,e.Uk)("geoadd"),Z=(0,e._)("td",null,"将指定的地理空间位置（纬度、经度、名称）添加到指定的 key 中",-1),D={href:"http://redisdoc.com/geo/geopos.html",target:"_blank",rel:"noopener noreferrer"},S=(0,e.Uk)("geopos"),K=(0,e._)("td",null,"从 key 里返回所有给定位置元素的位置（经度和纬度）",-1),V={href:"http://redisdoc.com/geo/geodist.html",target:"_blank",rel:"noopener noreferrer"},X=(0,e.Uk)("geodist"),A=(0,e._)("td",null,"返回两个给定位置之间的距离",-1),F={href:"http://redisdoc.com/geo/geohash.html",target:"_blank",rel:"noopener noreferrer"},N=(0,e.Uk)("geohash"),Y=(0,e.Uk)("回一个或多个位置元素的标准 Geohash 值，它可以在 "),J={href:"http://geohash.org/",target:"_blank",rel:"noopener noreferrer"},Q=(0,e.Uk)("http://geohash.org/"),nn=(0,e.Uk)(" 使用"),sn={href:"http://redisdoc.com/geo/georadius.html",target:"_blank",rel:"noopener noreferrer"},an=(0,e.Uk)("georadius"),en=(0,e._)("td",null,null,-1),pn={href:"http://redisdoc.com/geo/georadiusbymember.html",target:"_blank",rel:"noopener noreferrer"},tn=(0,e.Uk)("georadiusbymember"),on=(0,e._)("td",null,null,-1),ln=(0,e.uE)('<h3 id="geoadd" tabindex="-1"><a class="header-anchor" href="#geoadd" aria-hidden="true">#</a> geoadd</h3><p>添加地理位置。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> geoadd china:city <span class="token number">118.76</span> <span class="token number">32.04</span> manjing <span class="token number">112.55</span> <span class="token number">37.86</span> taiyuan <span class="token number">123.43</span> <span class="token number">41.80</span> shenyang\n<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span>\n<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> geoadd china:city <span class="token number">144.05</span> <span class="token number">22.52</span> shengzhen <span class="token number">120.16</span> <span class="token number">30.24</span> hangzhou <span class="token number">108.96</span> <span class="token number">34.26</span> xian\n<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>规则</strong></p>',4),rn=(0,e.Uk)("两级无法直接添加，我们一般会下载城市数据（这个网址可以查询 GEO： "),cn={href:"http://www.jsons.cn/lngcode",target:"_blank",rel:"noopener noreferrer"},un=(0,e.Uk)("http://www.jsons.cn/lngcode"),bn=(0,e.Uk)("）"),mn=(0,e.uE)('<ul><li>有效的经度从 <code>-180</code> 度到 <code>180</code> 度。</li><li>有效的纬度从 <code>-85.05112878</code> 度到 <code>85.05112878</code> 度。</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 当坐标位置超出上述指定范围时，该命令将会返回一个错误。</span>\n<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> geoadd china:city <span class="token number">39.90</span> <span class="token number">116.40</span> beijin\n<span class="token punctuation">(</span>error<span class="token punctuation">)</span> ERR invalid longitude,latitude pair <span class="token number">39.900000</span>,116.400000\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="geopos" tabindex="-1"><a class="header-anchor" href="#geopos" aria-hidden="true">#</a> geopos</h3><p>获取指定的成员的经度和纬度。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> geopos china:city taiyuan manjing\n<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;112.54999905824661255&quot;</span>\n   <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;37.86000073876942196&quot;</span>\n<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;118.75999957323074341&quot;</span>\n   <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;32.03999960287850968&quot;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>获得当前定位, 一定是一个坐标值!</p><h3 id="geodist" tabindex="-1"><a class="header-anchor" href="#geodist" aria-hidden="true">#</a> geodist</h3><p>如果不存在，返回空。</p><p>单位如下：</p><ul><li>m</li><li>km</li><li>mi 英里</li><li>ft 英尺</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> geodist china:city taiyuan shenyang m\n<span class="token string">&quot;1026439.1070&quot;</span>\n<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> geodist china:city taiyuan shenyang km\n<span class="token string">&quot;1026.4391&quot;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="georadius" tabindex="-1"><a class="header-anchor" href="#georadius" aria-hidden="true">#</a> georadius</h3><p>附近的人 ==&gt; 获得所有附近的人的地址, 定位, 通过半径来查询</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> georadius china:city <span class="token number">110</span> <span class="token number">30</span> <span class="token number">1000</span> km  <span class="token comment">#以 100,30 这个坐标为中心, 寻找半径为1000km的城市</span>\n<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;xian&quot;</span>\n<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;hangzhou&quot;</span>\n<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;manjing&quot;</span>\n<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;taiyuan&quot;</span>\n<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> georadius china:city <span class="token number">110</span> <span class="token number">30</span> <span class="token number">500</span> km\n<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;xian&quot;</span>\n<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> georadius china:city <span class="token number">110</span> <span class="token number">30</span> <span class="token number">500</span> km withdist\n<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;xian&quot;</span>\n   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;483.8340&quot;</span>\n<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> georadius china:city <span class="token number">110</span> <span class="token number">30</span> <span class="token number">1000</span> km withcoord withdist count <span class="token number">2</span>\n<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;xian&quot;</span>\n   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;483.8340&quot;</span>\n   <span class="token number">3</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;108.96000176668167114&quot;</span>\n      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;34.25999964418929977&quot;</span>\n<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;manjing&quot;</span>\n   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;864.9816&quot;</span>\n   <span class="token number">3</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;118.75999957323074341&quot;</span>\n      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;32.03999960287850968&quot;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>参数格式：<code>key 经度 纬度 半径 单位 [显示结果的经度和纬度] [显示结果的距离] [显示的结果的数量]</code></p><h3 id="georadiusbymember" tabindex="-1"><a class="header-anchor" href="#georadiusbymember" aria-hidden="true">#</a> georadiusbymember</h3><p>显示与指定成员一定半径范围内的其他成员。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> georadiusbymember china:city taiyuan <span class="token number">1000</span> km\n<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;manjing&quot;</span>\n<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;taiyuan&quot;</span>\n<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;xian&quot;</span>\n<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> georadiusbymember china:city taiyuan <span class="token number">1000</span> km withcoord withdist count <span class="token number">2</span>\n<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;taiyuan&quot;</span>\n   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;0.0000&quot;</span>\n   <span class="token number">3</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;112.54999905824661255&quot;</span>\n      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;37.86000073876942196&quot;</span>\n<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;xian&quot;</span>\n   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;514.2264&quot;</span>\n   <span class="token number">3</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;108.96000176668167114&quot;</span>\n      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;34.25999964418929977&quot;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>参数与 georadius 一样</p><h3 id="geohash-较少使用" tabindex="-1"><a class="header-anchor" href="#geohash-较少使用" aria-hidden="true">#</a> geohash(较少使用)</h3><p>该命令返回11个字符的hash字符串。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> geohash china:city taiyuan shenyang\n<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;ww8p3hhqmp0&quot;</span>\n<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;wxrvb9qyxk0&quot;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="底层" tabindex="-1"><a class="header-anchor" href="#底层" aria-hidden="true">#</a> 底层</h3><p>geo 底层的实现原理实际上就是 Zset，我们可以通过 Zset 命令来操作 geo。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">type</span> china:city\nzset\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>查看全部元素 删除指定的元素</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zrange china:city <span class="token number">0</span> -1 withscores\n <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;xian&quot;</span>\n <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;4040115445396757&quot;</span>\n <span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;hangzhou&quot;</span>\n <span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;4054133997236782&quot;</span>\n <span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;manjing&quot;</span>\n <span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">&quot;4066006694128997&quot;</span>\n <span class="token number">7</span><span class="token punctuation">)</span> <span class="token string">&quot;taiyuan&quot;</span>\n <span class="token number">8</span><span class="token punctuation">)</span> <span class="token string">&quot;4068216047500484&quot;</span>\n <span class="token number">9</span><span class="token punctuation">)</span> <span class="token string">&quot;shenyang&quot;</span>\n<span class="token number">1</span><span class="token punctuation">)</span>  <span class="token string">&quot;4072519231994779&quot;</span>\n<span class="token number">2</span><span class="token punctuation">)</span>  <span class="token string">&quot;shengzhen&quot;</span>\n<span class="token number">3</span><span class="token punctuation">)</span>  <span class="token string">&quot;4154606886655324&quot;</span>\n<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zrem china:city manjing\n<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>\n<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> zrange china:city <span class="token number">0</span> -1\n<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;xian&quot;</span>\n<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;hangzhou&quot;</span>\n<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;taiyuan&quot;</span>\n<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;shenyang&quot;</span>\n<span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;shengzhen&quot;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h2 id="参考资料" tabindex="-1"><a class="header-anchor" href="#参考资料" aria-hidden="true">#</a> 参考资料</h2><ul><li>https://www.pdai.tech/md/db/nosql-redis/db-redis-data-type-special.html</li></ul>',29),kn={},gn=(0,a(3744).Z)(kn,[["render",function(n,s){const a=(0,e.up)("OutboundLink");return(0,e.wg)(),(0,e.iD)(e.HY,null,[p,(0,e._)("ul",null,[(0,e._)("li",null,[(0,e._)("a",t,[o,(0,e.Wm)(a)]),l]),(0,e._)("li",null,[(0,e._)("a",r,[c,(0,e.Wm)(a)]),i]),(0,e._)("li",null,[(0,e._)("a",u,[b,(0,e.Wm)(a)]),m,k,g])]),d,(0,e._)("ul",null,[(0,e._)("li",null,[(0,e._)("a",h,[q,(0,e.Wm)(a)]),f,y,_]),(0,e._)("li",null,[(0,e._)("a",v,[x,(0,e.Wm)(a)]),L,U,w]),(0,e._)("li",null,[(0,e._)("a",H,[W,(0,e.Wm)(a)]),B,z,$]),(0,e._)("li",null,[(0,e._)("a",I,[j,(0,e.Wm)(a)])]),(0,e._)("li",null,[(0,e._)("a",M,[P,(0,e.Wm)(a)])]),(0,e._)("li",null,[(0,e._)("a",E,[R,(0,e.Wm)(a)])])]),G,(0,e._)("table",null,[T,(0,e._)("tbody",null,[(0,e._)("tr",null,[(0,e._)("td",null,[(0,e._)("a",O,[C,(0,e.Wm)(a)])]),Z]),(0,e._)("tr",null,[(0,e._)("td",null,[(0,e._)("a",D,[S,(0,e.Wm)(a)])]),K]),(0,e._)("tr",null,[(0,e._)("td",null,[(0,e._)("a",V,[X,(0,e.Wm)(a)])]),A]),(0,e._)("tr",null,[(0,e._)("td",null,[(0,e._)("a",F,[N,(0,e.Wm)(a)])]),(0,e._)("td",null,[Y,(0,e._)("a",J,[Q,(0,e.Wm)(a)]),nn])]),(0,e._)("tr",null,[(0,e._)("td",null,[(0,e._)("a",sn,[an,(0,e.Wm)(a)])]),en]),(0,e._)("tr",null,[(0,e._)("td",null,[(0,e._)("a",pn,[tn,(0,e.Wm)(a)])]),on])])]),ln,(0,e._)("p",null,[rn,(0,e._)("a",cn,[un,(0,e.Wm)(a)]),bn]),mn],64)}]])},3744:(n,s)=>{s.Z=(n,s)=>{for(const[a,e]of s)n[a]=e;return n}}}]);